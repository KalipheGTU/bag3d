

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quality of the 3D BAG &mdash; bag3d  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> bag3d
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="_modules/bag3d.html">bag3d package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bag3d</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Quality of the 3D BAG</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/quality.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quality-of-the-3d-bag">
<span id="quality"></span><h1>Quality of the 3D BAG<a class="headerlink" href="#quality-of-the-3d-bag" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quality-expectations">
<h2>Quality expectations<a class="headerlink" href="#quality-expectations" title="Permalink to this headline">¶</a></h2>
<p>These quality expectations describe the 3D-part of the 3D BAG. The quality of the BAG itself is not discussed here.</p>
<div class="section" id="completeness">
<h3>Completeness<a class="headerlink" href="#completeness" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Every BAG building footprint polygon should have a height assigned to it wherever AHN has data.</li>
<li>The date of AHN (height information) is assigned to every footprint. This includes the AHN version.</li>
<li>The binary attribute <cite>flat_roof</cite> is assigned to every footprint with height information.</li>
</ul>
</div>
<div class="section" id="correctness">
<h3>Correctness<a class="headerlink" href="#correctness" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Which part of the roof does <cite>roof-0.00</cite>, <cite>roof-0.50</cite> and <cite>roof-0.99</cite> relate to in the real building?</li>
<li>The newest avialable AHN is used for every footprint.</li>
</ul>
</div>
<div class="section" id="accountability">
<h3>Accountability<a class="headerlink" href="#accountability" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The source of BAG and AHN is clearly stated.</li>
<li>Logging into the <cite>bagactueel.bag3d_log</cite> table.</li>
<li>Data quality testing summary into the <cite>bagactueel.bag3d_info</cite> table.</li>
</ul>
</div>
</div>
<div class="section" id="quality-testing">
<h2>Quality testing<a class="headerlink" href="#quality-testing" title="Permalink to this headline">¶</a></h2>
<p>The following quality metrics are computed with every update:</p>
<table border="1" class="docutils">
<colgroup>
<col width="85%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Total nr. buildings</td>
<td>9989779</td>
</tr>
<tr class="row-even"><td>Buildings with valid height</td>
<td>96.33%</td>
</tr>
<tr class="row-odd"><td>Buildings missing height information for the roof</td>
<td>0.87%</td>
</tr>
<tr class="row-even"><td>Buildings missing height information for the ground</td>
<td>0.87%</td>
</tr>
</tbody>
</table>
<p>Additional to the metrics above, it is good to have an estimate on how well does a building model approximate the geometry of its real-world counter part. Therefore we computed the root mean square error (RMSE) of the geometric difference between the point cloud and the 3D building model at each percentile for 470 buildings in two areas of Delft. The <em>geometric difference</em> is represented by the shortest absolute distances <em>from</em> all point in the point cloud <em>to</em> the building model. Only those points are used from the point cloud that contribute to the creation of the 3D model.</p>
<p>The diagram of the RMSE of geometric difference, grouped by the type of the roof.</p>
<img alt="_images/rmse.png" class="align-center" src="_images/rmse.png" />
<div class="section" id="d-gebouwhoogte-nl">
<h3>3D gebouwhoogte NL<a class="headerlink" href="#d-gebouwhoogte-nl" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="https://www.kadaster.nl/-/3d-gebouwhoogte-nl">3D gebouwhoogte NL</a> data set is probably what is the closest to what the 3D BAG offers. There are two major differences however. First, the 3D BAG is continuously updated along with the BAG while the 3D geobouwhoogte was last updated in 2015 and the heights are based on the AHN2. Second, the 3D geobouwhoogte is generated from a map of 1:10000 scale, thus the geometry of the building footprints are considerably less detailed than those in the BAG.</p>
</div>
<div class="section" id="esri-s-3d-bag">
<h3>Esri’s 3D BAG<a class="headerlink" href="#esri-s-3d-bag" title="Permalink to this headline">¶</a></h3>
<p>The GIS software company Esri offers open data set which is based on the BAG and AHN too (eg. <a class="reference external" href="https://hub.arcgis.com/items/esrinl-content::bag-3-d-provincies-1">provinces</a>. However, it is not clear whether the height information is still relevant for each building, neither it is stated what the top surface in the model relates to in the real world. These properties make the data set unsuitable for noise simulations for example.</p>
</div>
<div class="section" id="comparing-the-3d-bag-heights-to-the-ahn-0-5m-dsm">
<h3>Comparing the 3D BAG heights to the AHN 0.5m DSM<a class="headerlink" href="#comparing-the-3d-bag-heights-to-the-ahn-0-5m-dsm" title="Permalink to this headline">¶</a></h3>
<p>There are several height values computed for each building. These are
the values of the ground and roof surface at different heights. For
example:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>id</td>
<td>ground-0.00</td>
<td>ground-0.10</td>
<td>ground-0.20</td>
<td>ground-0.30</td>
<td>ground-0.40</td>
<td>ground-0.50</td>
<td>roof-0.00</td>
<td>roof-0.10</td>
<td>roof-0.25</td>
<td>roof-0.50</td>
<td>roof-0.75</td>
<td>roof-0.90</td>
<td>roof-0.95</td>
<td>roof-0.99</td>
</tr>
<tr class="row-even"><td>b31bdd44c-00ba-11e6-b420-2bdcc4ab5d7f</td>
<td>-0.03</td>
<td>0.01</td>
<td>0.02</td>
<td>0.02</td>
<td>0.03</td>
<td>0.04</td>
<td>-0.03</td>
<td>0.01</td>
<td>0.02</td>
<td>0.04</td>
<td>0.11</td>
<td>2.36</td>
<td>2.38</td>
<td>2.44</td>
</tr>
</tbody>
</table>
<p>The height values are derived from a point cloud. When using a point
cloud that was acquired by airborne laser scanning (eg. AHN), most of
the points are “on” the roof of the building, and there can be various
amounts of points on the walls.</p>
<p>The AHN 0.5m DSM is used as reference, both AHN2 and AHN3. Our
assumption is that in the higher percentile range (eg. 70-99) the
difference between the 3dfier output and the AHN-raster will be low,
while in the lower percentile range the difference will be high.</p>
<p>The differences in percentiles are computed as:</p>
<blockquote>
<div>difference = 3dbag_percentile - reference_percentile</div></blockquote>
<p>Where <em>reference_percentile</em> is computed with the
<a class="reference external" href="https://pythonhosted.org/rasterstats/manual.html#zonal-statistics">zonal_stats</a>
function of the <em>rasterstats</em> python library. The function takes a list
of polygons and computes zonal statistics on a raster for each polygon.
Thus in our case the zonal statistics are <em>percentile 10, percentile 20
etc.</em>, which are the same that the 3D BAG contains.</p>
<p>Number of buildings in the test sample: <strong>185871</strong></p>
<p>The statistical summary together with the box plot confirms that there are some very heavy outliers in the distances that were computed from the AHN3 raster. For now we ignore the reason for having differences in the range of thousands of meters.</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="13%" />
<col width="11%" />
<col width="15%" />
<col width="18%" />
<col width="11%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Min.</td>
<td>1st Qu.</td>
<td>Median</td>
<td>Mean</td>
<td>3rd Qu.</td>
<td>Max.</td>
<td>NA’s</td>
</tr>
<tr class="row-even"><td>-133.499</td>
<td>0.869</td>
<td>2.402</td>
<td>6.206</td>
<td>4.968</td>
<td>10012.240</td>
<td>17881</td>
</tr>
</tbody>
</table>
<img alt="_images/q_box1.png" class="align-center" src="_images/q_box1.png" />
<p>We the interquartile range to identify and remove the largest outliers. Given that <em>Q_1</em> and <em>Q_3</em> denote the first and third quartiles, <em>IQR</em> denotes the interquartile range, then a data point <em>p</em> is considered an outlier if:</p>
<blockquote>
<div>p &lt; Q_1 - (1.5 * IQR)</div></blockquote>
<p>or</p>
<blockquote>
<div>p &gt; Q_3 - (1.5 * IQR)</div></blockquote>
<p>With this method the lower limit for being an outlier is set to <em>-5.23</em>, the upper limit to <em>11.11</em> meters difference and we remove <em>1.96%</em> of the data points. However, the difference in height values is still suspiciously high in the box plots below. They indicate that 2.5–5m height difference is common in the 50th–99th percentile range.</p>
<img alt="_images/q_box2.png" class="align-center" src="_images/q_box2.png" />
<p>Let’s take a closer look at the difference between the building heights obtained from the AHN DSM and the 3D BAG. The plot below shows the median building heights across the whole sample at each of the seven percentiles. We can clearly see that in case of the 3D BAG the median height of the buildings is increasing with the percentiles, which is according to the expectation. However, in case of the AHN raster the heights fall very close to 4 meters across all percentiles. This behavior is mainly due to the relatively coarse resolution of the raster and the sampling method for creating the raster.</p>
<img alt="_images/q_box3.png" class="align-center" src="_images/q_box3.png" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Balázs Dukai.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>